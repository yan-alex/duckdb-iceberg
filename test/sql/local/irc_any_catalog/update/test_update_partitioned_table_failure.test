# name: test/sql/local/irc_any_catalog/update/test_update_partitioned_table_failure.test
# description: Test there are no new snapshots if there are no new updates
# group: [update]

require-env ICEBERG_SERVER_AVAILABLE

require-env SECRETS_CREATED_AND_CATALOG_ATTACHED

require avro

require parquet

require iceberg

require httpfs

# Do not ignore 'HTTP' error messages!
set ignore_error_messages

statement ok
CALL enable_logging('HTTP');

statement ok
set logging_level='debug'

statement ok
select 1 from my_datalake.default.lineitem_partitioned_l_shipmode limit 1;

statement error
update my_datalake.default.lineitem_partitioned_l_shipmode set l_linenumber = 100 where l_linenumber % 5 = 0;
----
<REGEX>:.*Not implemented.*Update into a partitioned table.*